Description: Fixes CVE-2016-0762: The Realm implementations did not process
 the supplied password if the supplied user name did not exist. This made
 a timing attack possible to determine valid user names.
Origin: backport, https://svn.apache.org/r1758502
--- a/java/org/apache/catalina/realm/MemoryRealm.java
+++ b/java/org/apache/catalina/realm/MemoryRealm.java
@@ -115,6 +115,9 @@
 
         boolean validated;
         if (principal == null) {
+            // User was not found in the database
+            // Waste a bit of time as not to reveal that the user does not exist.
+            compareCredentials(credentials, getClass().getName());
             validated = false;
         } else {
             validated = compareCredentials(credentials, principal.getPassword());
--- a/java/org/apache/catalina/realm/RealmBase.java
+++ b/java/org/apache/catalina/realm/RealmBase.java
@@ -500,6 +500,9 @@
             String serverCredentials) {
 
         if (serverCredentials == null) {
+            // User was not found
+            // Waste a bit of time as not to reveal that the user does not exist.
+            compareCredentials(userCredentials, getClass().getName());
             return false;
         }
 
