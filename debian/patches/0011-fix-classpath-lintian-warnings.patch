Description: Fix codeless-jar and missing-classpath lintian warnings
Author: Miguel Landaeta <miguel@miguel.cc>
Forwarded: no
Last-Update: 2011-05-16

--- a/build.xml
+++ b/build.xml
@@ -686,7 +686,8 @@
     <!-- Jasper Implementation JAR File -->
     <jarIt jarfile="${jasper.jar}"
       filesDir="${tomcat.classes}"
-      filesId="files.jasper" />
+      filesId="files.jasper"
+      manifest="${tomcat.manifests}/jasper.jar.manifest" />
 
     <!-- Jasper EL Implementation JAR File -->
     <jarIt jarfile="${jasper-el.jar}"
@@ -694,8 +695,7 @@
       filesId="files.jasper-el" />
 
     <!-- i18n JARs -->
-    <jar jarfile="${tomcat.build}/lib/tomcat-i18n-es.jar"
-      manifest="${tomcat.manifests}/default.manifest" >
+    <zip destfile="${tomcat.build}/lib/tomcat-i18n-es.jar">
       <fileset dir="${tomcat.classes}">
         <include name="**/LocalStrings_es.properties" />
       </fileset>
@@ -703,9 +703,8 @@
         fullpath="META-INF/NOTICE" />
       <zipfileset file="${tomcat.manifests}/default.license"
         fullpath="META-INF/LICENSE" />
-    </jar>
-    <jar jarfile="${tomcat.build}/lib/tomcat-i18n-fr.jar"
-      manifest="${tomcat.manifests}/default.manifest" >
+    </zip>
+    <zip destfile="${tomcat.build}/lib/tomcat-i18n-fr.jar">
       <fileset dir="${tomcat.classes}">
         <include name="**/LocalStrings_fr.properties" />
       </fileset>
@@ -713,9 +712,8 @@
         fullpath="META-INF/NOTICE" />
       <zipfileset file="${tomcat.manifests}/default.license"
         fullpath="META-INF/LICENSE" />
-    </jar>
-    <jar jarfile="${tomcat.build}/lib/tomcat-i18n-ja.jar"
-      manifest="${tomcat.manifests}/default.manifest" >
+    </zip>
+    <zip destfile="${tomcat.build}/lib/tomcat-i18n-ja.jar">
       <fileset dir="${tomcat.classes}">
         <include name="**/LocalStrings_ja.properties" />
       </fileset>
@@ -723,7 +721,7 @@
         fullpath="META-INF/NOTICE" />
       <zipfileset file="${tomcat.manifests}/default.license"
         fullpath="META-INF/LICENSE" />
-    </jar>
+    </zip>
 
   </target>
 
--- /dev/null
+++ b/res/META-INF/jasper.jar.manifest
@@ -0,0 +1,10 @@
+Manifest-Version: 1.0
+Specification-Title: Apache Tomcat
+Specification-Version: @VERSION_MAJOR_MINOR@
+Specification-Vendor: Apache Software Foundation
+Implementation-Title: Apache Tomcat
+Implementation-Version: @VERSION@
+Implementation-Vendor: Apache Software Foundation
+X-Compile-Source-JDK: @source.jdk@
+X-Compile-Target-JDK: @target.jdk@
+Class-Path: ecj.jar tomcat-el-api-2.2.jar tomcat-servlet-api-3.0.jar tomcat-jsp-api-2.2.jar
